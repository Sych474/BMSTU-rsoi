sudo: true
dist: trusty

jobs:
  include:
    #- stage: build docker image
    #  script:
    #  - docker login -u=$DOCKER_USERNAME -p=$DOCKER_PASSWORD 
    #  - docker build -t sych474/$SERVICE_NAME:1 ./Rsoi.Net/CharactersHub
    #  - docker push sych474/$SERVICE_NAME:1

    - stage: deploy to remote
      script: 
      - sudo apt-get install sshpass
      - sshpass -p $DEPLOY_HOST_USER_PASSWORD scp -o StrictHostKeyChecking=no docker-compose.yml $DEPLOY_HOST_USER@$DEPLOY_HOST_ADDRESS:~;
      - sshpass -p "$DEPLOY_HOST_USER_PASSWORD" ssh -o StrictHostKeyChecking=no $DEPLOY_HOST_USER@$DEPLOY_HOST_ADDRESS bash -s < DeployScripts/deploy_to_prod.sh